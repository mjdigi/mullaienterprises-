<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Paint & Electrics Store</title>
<style>
:root {
  --bg: #121212;
  --panel: #1e1e1e;
  --muted: #b0bec5;
  --text: #e0e0e0;
  --brand: #64b5f6;
  --accent: #fbc02d;
  --danger: #e57373;
  --warn: #ffb74d;
  --ok: #81c784;
  --card: #212121;
}

* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  margin: 0;
  background-color: var(--bg);
  color: var(--text);
  font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 24px;
}

.nav {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  align-items: center;
  justify-content: space-between;
}

.brand {
  display: flex;
  gap: 10px;
  align-items: center;
  font-weight: 700;
  letter-spacing: 0.4px;
  color: var(--brand);
}

.brand .dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: var(--brand);
}

.tabs {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.btn {
  border: 1px solid var(--muted);
  background-color: transparent;
  color: var(--text);
  padding: 10px 14px;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.2s background-color, 0.2s border-color;
}

.btn:hover {
  background-color: rgba(255, 255, 255, 0.05);
  border-color: var(--text);
}

.btn.primary {
  background-color: var(--brand);
  border-color: var(--brand);
  color: #fff;
}

.btn.primary:hover {
  background-color: rgba(100, 181, 246, 0.8);
}

.btn.warn {
  background-color: var(--warn);
  border-color: var(--warn);
  color: #fff;
}

.btn.warn:hover {
  background-color: rgba(255, 183, 77, 0.8);
}

.btn.accent {
  background-color: var(--accent);
  border-color: var(--accent);
  color: #fff;
}

.btn.accent:hover {
  background-color: rgba(251, 192, 45, 0.8);
}

.grid {
  display: grid;
  gap: 16px;
}

.grid.cols-3 {
  grid-template-columns: repeat(3, 1fr);
}

.grid.cols-2 {
  grid-template-columns: repeat(2, 1fr);
}

@media (max-width: 900px) {
  .grid.cols-3 {
    grid-template-columns: 1fr;
  }
  .grid.cols-2 {
    grid-template-columns: 1fr;
  }
}

.card {
  background-color: var(--card);
  border: 1px solid var(--panel);
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.muted {
  color: var(--muted);
}

.stat {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.stat .value {
  font-size: 28px;
  font-weight: 800;
  color: var(--text);
}

.chip {
  display: inline-flex;
  gap: 6px;
  align-items: center;
  background-color: var(--panel);
  border: 1px solid var(--muted);
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 12px;
}

input,
select,
textarea {
  background-color: var(--panel);
  color: var(--text);
  border: 1px solid var(--muted);
  border-radius: 8px;
  padding: 10px 12px;
  width: 100%;
}

label {
  font-size: 12px;
  color: var(--muted);
}

table {
  width: 100%;
  border-collapse: collapse;
}

th,
td {
  padding: 12px;
  border-bottom: 1px solid var(--panel);
  text-align: left;
}

th {
  color: var(--muted);
  font-weight: 600;
}

.right {
  text-align: right;
}

.hidden {
  display: none;
}

.success {
  color: var(--ok);
}

.error {
  color: var(--danger);
}

.toolbar {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.kbd {
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  background: var(--panel);
  border: 1px solid var(--muted);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;
}

.footer {
  margin-top: 28px;
  color: var(--muted);
  font-size: 12px;
  text-align: center;
}

.pill {
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid var(--muted);
  background: var(--panel);
}

.total {
  font-weight: 800;
}

.link {
  color: var(--brand);
  text-decoration: none;
}

#loader-bar {
  position: fixed;
  top: 0;
  left: 0;
  height: 4px;
  background: var(--brand);
  width: 0;
  transition: width 0.3s ease;
}

.print-area {
  display: none;
}

@media print {
  body * {
    visibility: hidden;
  }
  .print-area,
  .print-area * {
    visibility: visible;
  }
  .print-area {
    position: absolute;
    top: 0;
    left: 0;
    width: 300px;
    margin: 0;
    padding: 10px;
  }
}
</style>
</head>
<body>
<div id="loader-bar"></div>
<div class="container">
<div class="nav">
  <div class="brand"><span class="dot"></span> Paint & Electrics Store</div>
  <div class="tabs">
    <button class="btn" data-view="start">Start</button>
    <button class="btn" data-view="dashboard">Dashboard</button>
    <button class="btn" data-view="stock">Stock Management</button>
    <button class="btn" data-view="invoice">Invoice</button>
  </div>
</div>

<!-- START PAGE -->
<section id="view-start" class="card" style="margin-top:16px">
  <h2>Welcome ðŸ‘‹</h2>
  <p class="muted">A lightweight web app for a paint shop & electrics store. Uses Firebase Firestore to store products and invoices.</p>
</section>

<!-- DASHBOARD -->
<section id="view-dashboard" class="card hidden" style="margin-top:16px">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
    <h2>Dashboard</h2>
    <div class="chip">Live from Firestore</div>
  </div>
  <div class="grid cols-3" style="margin-top:12px">
    <div class="card stat">
      <div class="muted">Total Products</div>
      <div id="stat-total-products" class="value">0</div>
    </div>
    <div class="card stat">
      <div class="muted">Total Stock Units</div>
      <div id="stat-total-stock" class="value">0</div>
    </div>
    <div class="card stat">
      <div class="muted">Inventory Value (â‚¹)</div>
      <div id="stat-total-amount" class="value">0.00</div>
    </div>
  </div>
  <div class="card" style="margin-top:12px">
    <h3>Low Stock Alerts</h3>
    <table>
      <thead><tr><th>Code</th><th>Name</th><th>Stock</th><th>Unit Price</th></tr></thead>
      <tbody id="low-stock-body"><tr><td colspan="4" class="muted">No low stock items.</td></tr></tbody>
    </table>
  </div>
</section>

<!-- STOCK MANAGEMENT -->
<section id="view-stock" class="card hidden" style="margin-top:16px">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
    <h2>Stock Management</h2>
    <div class="toolbar">
      <input id="search" placeholder="Search code or name ( / )" />
      <button class="btn" id="btn-export">Export CSV</button>
      <label class="btn" for="csv-input">Import CSV</label>
      <input id="csv-input" type="file" accept=".csv" style="display:none" />
    </div>
  </div>
  <div class="grid cols-2" style="margin-top:12px">
    <div class="card">
      <h3>Add / Edit Product</h3>
      <div class="grid cols-2">
        <div>
          <label>Product Code</label>
          <input id="p-code" placeholder="e.g., PNT-001" />
        </div>
        <div>
          <label>Name</label>
          <input id="p-name" placeholder="Asian Paints Royale" />
        </div>
        <div>
          <label>Category</label>
          <input id="p-cat" placeholder="Paint / Electrical" />
        </div>
        <div>
          <label>Unit Price (â‚¹)</label>
          <input id="p-price" type="number" min="0" step="0.01" />
        </div>
        <div>
          <label>Stock Units</label>
          <input id="p-stock" type="number" min="0" step="1" />
        </div>
      </div>
      <div class="toolbar" style="margin-top:10px">
        <button class="btn primary" id="btn-save">Save</button>
        <button class="btn" id="btn-reset">Reset</button>
        <button class="btn warn" id="btn-delete">Delete</button>
        <div id="save-msg" class="muted"></div>
      </div>
    </div>

    <div class="card">
      <h3>Products</h3>
      <table>
        <thead>
          <tr><th>Code</th><th>Name</th><th>Category</th><th class="right">Unit Price</th><th class="right">Stock</th></tr>
        </thead>
        <tbody id="products-body"><tr><td colspan="5" class="muted">Loading...</td></tr></tbody>
      </table>
    </div>
  </div>
</section>

<!-- INVOICE -->
<section id="view-invoice" class="card hidden" style="margin-top:16px">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
    <h2>Invoice</h2>
    <div class="toolbar">
      <button class="btn" id="btn-new-invoice">New</button>
      <button class="btn primary" id="btn-save-invoice">Save Invoice</button>
      <button class="btn accent" id="btn-print-invoice">Print</button>
    </div>
  </div>

  <div class="grid cols-3" style="margin-top:12px">
    <div>
      <label>Invoice No.</label>
      <input id="inv-no" placeholder="AUTO" disabled />
    </div>
    <div>
      <label>Customer Name</label>
      <input id="cust-name" placeholder="Customer Name" />
    </div>
    <div>
      <label>Date</label>
      <input id="inv-date" type="date" />
    </div>
  </div>

  <div class="grid cols-3" style="margin-top:12px;gap:8px">
    <div>
      <label>Customer Phone</label>
      <input id="cust-phone" placeholder="Phone" />
    </div>
    <div>
      <label>Customer Email</label>
      <input id="cust-email" placeholder="Email" />
    </div>
    <div>
      <label>Customer Address</label>
      <input id="cust-address" placeholder="Address" />
    </div>
  </div>

  <div class="card" style="margin-top:12px">
    <table>
      <thead>
        <tr>
          <th style="width:140px">Product Code</th>
          <th>Name</th>
          <th class="right">Unit Price</th>
          <th class="right">Available</th>
          <th class="right" style="width:120px">Qty</th>
          <th class="right">Line Total</th>
          <th></th>
        </tr>
      </thead>
<div class="toolbar" style="margin-top:10px">
      <button class="btn" id="btn-add-line">Add</button>
      <div id="inv-msg" class="muted"></div>
    </div>
      <tbody id="inv-body"></tbody>
      <tfoot>
        <tr>
          <td colspan="5" class="right total">Subtotal (â‚¹)</td>
          <td class="right total" id="sub-total">0.00</td>
          <td></td>
        </tr>
        <tr>
          <td colspan="5" class="right total">Discount (â‚¹)</td>
          <td class="right total"><input type="number" id="inv-discount" min="0" value="0" style="width:100px"></td>
          <td></td>
        </tr>
        <tr>
          <td colspan="5" class="right total">GST (%)</td>
          <td class="right total"><input type="number" id="inv-gst" min="0" value="18" style="width:100px"></td>
          <td></td>
        </tr>
        <tr>
          <td colspan="5" class="right total">GST Amount (â‚¹)</td>
          <td class="right total" id="gst-amt">0.00</td>
          <td></td>
        </tr>
        <tr>
          <td colspan="5" class="right total">Grand Total (â‚¹)</td>
          <td class="right total" id="grand-total">0.00</td>
          <td></td>
        </tr>
        <tr>
          <td colspan="5" class="right total">Paid Amount (â‚¹)</td>
          <td class="right total"><input type="number" id="inv-paid" min="0" value="0" style="width:100px"></td>
          <td></td>
        </tr>
        <tr>
          <td colspan="5" class="right total">Balance (â‚¹)</td>
          <td class="right total" id="inv-balance">0.00</td>
          <td></td>
        </tr>
      </tfoot>
    </table>
  </div>
</section>

<div class="footer">Made for quick demos â€¢ Replace Firebase config below â€¢ Firestore collections: <span class="kbd">products</span>, <span class="kbd">invoices</span></div>
</div>

<div class="print-area" id="print-area"></div>

<script type="module">
const firebaseConfig = {
  apiKey: "AIzaSyCOfYScRtu_r2p1MlDVGT_BSnR4VWe1kIU",
  authDomain: "villagefood-19f8a.firebaseapp.com",
  projectId: "villagefood-19f8a",
  storageBucket: "villagefood-19f8a.firebasestorage.app",
  messagingSenderId: "241737075683",
  appId: "1:241737075683:web:e3a7351cdbdbf77116aed6",
  measurementId: "G-1HH6F13ECS"
};

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, doc, getDoc, getDocs, setDoc, deleteDoc, onSnapshot, query, orderBy, runTransaction } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const byId=id=>document.getElementById(id);
const qs=(s,el=document)=>el.querySelector(s);
const qsa=(s,el=document)=>[...el.querySelectorAll(s)];
const fmt=n=>(Number(n)||0).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});

const views={start:byId('view-start'), dashboard:byId('view-dashboard'), stock:byId('view-stock'), invoice:byId('view-invoice')};
function switchView(name){Object.values(views).forEach(v=>v.classList.add('hidden')); views[name].classList.remove('hidden'); localStorage.setItem('view',name);}
qsa('[data-view]').forEach(b=>b.addEventListener('click',()=>switchView(b.dataset.view)));
switchView(localStorage.getItem('view')||'start');

window.addEventListener('keydown',e=>{if(e.key==='/'&&document.activeElement.tagName!=='INPUT'){e.preventDefault();byId('search').focus();}});

const productsCol = collection(db,'products');
const invoicesCol = collection(db,'invoices');

// State
const state={products:[]};

// DASHBOARD
function bindDashboard(){
  const qAll = query(productsCol, orderBy('code'));
  onSnapshot(qAll, snap => {
    let totalProducts=0,totalUnits=0,totalAmount=0;
    const low=[];
    snap.forEach(docu=>{
      const p = docu.data();
      totalProducts++; totalUnits += Number(p.stock)||0; totalAmount += (Number(p.unitPrice)||0)*(Number(p.stock)||0);
      if((Number(p.stock)||0)<=5) low.push(p);
    });
    byId('stat-total-products').textContent=totalProducts;
    byId('stat-total-stock').textContent=totalUnits;
    byId('stat-total-amount').textContent=fmt(totalAmount);
    const body = byId('low-stock-body'); body.innerHTML='';
    if(low.length===0){ body.innerHTML='<tr><td colspan="4" class="muted">No low stock items.</td></tr>'; return; }
    low.sort((a,b)=> (a.stock||0)-(b.stock||0));
    for(const p of low){ const tr=document.createElement('tr'); tr.innerHTML=`<td>${p.code||''}</td><td>${p.name||''}</td><td class="right">${p.stock||0}</td><td class="right">â‚¹ ${fmt(p.unitPrice||0)}</td>`; body.appendChild(tr); }
  });
}
bindDashboard();

// STOCK MANAGEMENT
const productsBody = byId('products-body');
const searchInput = byId('search');

function renderProducts(rows){
  productsBody.innerHTML='';
  if(rows.length===0){ productsBody.innerHTML='<tr><td colspan="5" class="muted">No products. Add or import CSV.</td></tr>'; return; }
  for(const p of rows){ const tr=document.createElement('tr'); tr.innerHTML=`<td><a href="#" class="link" data-code="${p.code}">${p.code}</a></td><td>${p.name}</td><td>${p.category||''}</td><td class="right">â‚¹ ${fmt(p.unitPrice)}</td><td class="right">${p.stock}</td>`; productsBody.appendChild(tr);}
  qsa('[data-code]',byId('view-stock')).forEach(a=> a.addEventListener('click', async (e)=>{ e.preventDefault(); const snap=await getDoc(doc(db,'products',a.dataset.code)); if(snap.exists()) fillForm(snap.data());}));
}

function fillForm(p){ ['p-code','p-name','p-cat','p-price','p-stock'].forEach(id=>byId(id).value=p[id.replace('p-','')]||p[id.replace('p-','code')]); byId('p-code').focus();}
async function loadProducts(){ const snap = await getDocs(query(productsCol, orderBy('code'))); state.products = snap.docs.map(d=>d.data()); renderProducts(filterProducts(state.products, searchInput.value.trim()));}
function filterProducts(arr, term){ if(!term) return arr; term=term.toLowerCase(); return arr.filter(p=>(p.code||'').toLowerCase().includes(term)||(p.name||'').toLowerCase().includes(term)); }
searchInput.addEventListener('input',()=>renderProducts(filterProducts(state.products, searchInput.value.trim())));

byId('btn-save').addEventListener('click', async ()=>{
  const code=byId('p-code').value.trim(); if(!code){ msg('#save-msg','Enter product code',true); return;}
  const p={code, name:byId('p-name').value.trim(), category:byId('p-cat').value.trim(), unitPrice:Number(byId('p-price').value)||0, stock:Math.max(0,parseInt(byId('p-stock').value||'0')), updatedAt:new Date().toISOString()};
  await setDoc(doc(db,'products',code),p); msg('#save-msg','Saved âœ“'); await loadProducts();
});
byId('btn-reset').addEventListener('click',()=>['p-code','p-name','p-cat','p-price','p-stock'].forEach(i=>byId(i).value=''));
byId('btn-delete').addEventListener('click', async ()=>{
  const code=byId('p-code').value.trim(); if(!code||!confirm(`Delete ${code}?`)) return;
  await deleteDoc(doc(db,'products',code)); msg('#save-msg','Deleted'); byId('btn-reset').click(); await loadProducts();
});

// INVOICE LOGIC
const invBody = byId('inv-body');
const subTotalEl = byId('sub-total');
const gstAmtEl = byId('gst-amt');
const grandTotalEl = byId('grand-total');
const balanceEl = byId('inv-balance');
const discountEl = byId('inv-discount');
const gstRateEl = byId('inv-gst');
const paidEl = byId('inv-paid');
const loader = byId('loader-bar');

function newInvoice(){
  ['inv-no','cust-name','cust-phone','cust-email','cust-address'].forEach(id=>byId(id).value='');
  byId('inv-date').value = new Date().toISOString().slice(0,10);
  invBody.innerHTML=''; addLine(); addLine();
  updateTotals(); msg('#inv-msg',''); discountEl.value=0; gstRateEl.value=18; paidEl.value=0;
}

function addLine(pref={}){ const tr=document.createElement('tr'); tr.innerHTML=`<td><input class="code" placeholder="code" value="${pref.code||''}"></td><td class="name muted"></td><td class="right price">0.00</td><td class="right avail">0</td><td class="right"><input class="qty" type="number" min="1" step="1" value="${pref.qty||''}"></td><td class="right line">0.00</td><td><button class="btn warn btn-del">âœ•</button></td>`; invBody.appendChild(tr); bindLine(tr);}
function bindLine(tr){ const codeInput=qs('.code',tr); const qtyInput=qs('.qty',tr); const delBtn=qs('.btn-del',tr); codeInput.addEventListener('change',()=>resolveCode(tr)); codeInput.addEventListener('blur',()=>resolveCode(tr)); qtyInput.addEventListener('input',()=>updateLine(tr)); delBtn.addEventListener('click',()=>{tr.remove(); updateTotals();}); }
async function resolveCode(tr){ const code=qs('.code',tr).value.trim(); if(!code){ qs('.name',tr).textContent=''; qs('.price',tr).textContent='0.00'; qs('.avail',tr).textContent='0'; updateLine(tr); return;}
  const snap = await getDoc(doc(db,'products',code));
  if(!snap.exists()){ qs('.name',tr).textContent='Not found'; qs('.name',tr).classList.add('error'); qs('.price',tr).textContent='0.00'; qs('.avail',tr).textContent='0';}
  else{ const p=snap.data(); qs('.name',tr).textContent=p.name||''; qs('.name',tr).classList.remove('error'); qs('.price',tr).textContent=fmt(p.unitPrice||0); qs('.avail',tr).textContent=String(p.stock||0);}
  updateLine(tr);
}
function updateLine(tr){ const price=Number(qs('.price',tr).textContent.replace(/,/g,''))||0; const qty=Math.max(0,parseInt(qs('.qty',tr).value||'0')); qs('.line',tr).textContent=fmt(price*qty); updateTotals(); }

function updateTotals(){
  let subtotal=0;
  qsa('tr',invBody).forEach(tr=>{subtotal += Number(qs('.line',tr).textContent.replace(/,/g,''))||0;});
  subTotalEl.textContent=fmt(subtotal);
  const discount = Number(discountEl.value)||0;
  const gstRate = Number(gstRateEl.value)||0;
  const taxable = Math.max(0, subtotal - discount);
  const gstAmt = taxable * gstRate/100;
  gstAmtEl.textContent = fmt(gstAmt);
  const grand = taxable + gstAmt;
  grandTotalEl.textContent = fmt(grand);
  const paid = Number(paidEl.value)||0;
  balanceEl.textContent = fmt(Math.max(0,grand-paid));
}
discountEl.addEventListener('input',updateTotals);
gstRateEl.addEventListener('input',updateTotals);
paidEl.addEventListener('input',updateTotals);
byId('btn-add-line').addEventListener('click',()=>addLine());
byId('btn-new-invoice').addEventListener('click',newInvoice);

byId('btn-save-invoice').addEventListener('click', async ()=>{
  loader.style.width='0%'; loader.style.transition='width 0.1s'; loader.style.width='20%';
  const lines = qsa('tr',invBody).map(tr=>({code:qs('.code',tr).value, qty:parseInt(qs('.qty',tr).value)||0, unitPrice:parseFloat(qs('.price',tr).textContent.replace(/,/g,'')), lineTotal:parseFloat(qs('.line',tr).textContent.replace(/,/g,''))})).filter(l=>l.qty>0);
  if(lines.length===0){msg('#inv-msg','No items to save',true); loader.style.width='0%'; return;}
  const invData={invoiceNo:'INV-'+Date.now(), customer:{name:byId('cust-name').value,phone:byId('cust-phone').value,email:byId('cust-email').value,address:byId('cust-address').value}, date:byId('inv-date').value, lines, discount:Number(discountEl.value)||0, gstRate:Number(gstRateEl.value)||0, gstAmt:Number(gstAmtEl.textContent.replace(/,/g,'')), grandTotal:Number(grandTotalEl.textContent.replace(/,/g,'')), paid:Number(paidEl.value)||0, balance:Number(balanceEl.textContent.replace(/,/g,'')) };
  loader.style.width='50%';
  await setDoc(doc(db,'invoices',invData.invoiceNo),invData);
  loader.style.width='100%';
  setTimeout(()=>loader.style.width='0%',300);
  msg('#inv-msg','Invoice Saved âœ“'); newInvoice();
});

byId('btn-print-invoice').addEventListener('click', ()=>{
  const linesHTML = qsa('tr',invBody).map(tr=>`<tr><td>${qs('.code',tr).value}</td><td>${qs('.name',tr).textContent}</td><td class="right">${qs('.price',tr).textContent}</td><td class="right">${qs('.qty',tr).value}</td><td class="right">${qs('.line',tr).textContent}</td></tr>`).join('');
  const html=`<h2>Paint & Electrics Store</h2>
  <p>${byId('cust-name').value||''} | ${byId('cust-phone').value||''}</p>
  <table border="0" cellspacing="0" cellpadding="0" style="width:100%">
    <thead><tr><th>Code</th><th>Name</th><th class="right">Unit</th><th class="right">Qty</th><th class="right">Total</th></tr></thead>
    <tbody>${linesHTML}</tbody>
    <tfoot>
      <tr><td colspan="4" class="right">Subtotal</td><td class="right">${subTotalEl.textContent}</td></tr>
      <tr><td colspan="4" class="right">Discount</td><td class="right">${discountEl.value}</td></tr>
      <tr><td colspan="4" class="right">GST ${gstRateEl.value}%</td><td class="right">${gstAmtEl.textContent}</td></tr>
      <tr><td colspan="4" class="right">Grand Total</td><td class="right">${grandTotalEl.textContent}</td></tr>
      <tr><td colspan="4" class="right">Paid</td><td class="right">${paidEl.value}</td></tr>
      <tr><td colspan="4" class="right">Balance</td><td class="right">${balanceEl.textContent}</td></tr>
    </tfoot>
  </table>`;
  const printArea=byId('print-area'); printArea.innerHTML=html; window.print();
});

function msg(sel,text,error=false){ const el=byId(sel.replace('#','')); el.textContent=text; el.className=error?'error':'muted'; }

loadProducts();
newInvoice();
</script>
